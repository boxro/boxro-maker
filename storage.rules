rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // 사용자 프로필 이미지
    match /users/{userId}/profile/{fileName} {
      allow read: if true; // 모든 사용자가 읽기 가능
      allow write: if request.auth != null && request.auth.uid == userId; // 해당 사용자만 쓰기 가능
    }
    
    // 갤러리 디자인 이미지
    match /community-designs/{designId}/{fileName} {
      allow read: if true; // 모든 사용자가 읽기 가능
      allow write: if request.auth != null; // 로그인된 사용자만 쓰기 가능
    }
    
    // 사용자 개인 디자인 이미지
    match /user-designs/{userId}/{designId}/{fileName} {
      allow read, write: if request.auth != null && request.auth.uid == userId; // 해당 사용자만 접근 가능
    }
    
    // 홈카드 썸네일 이미지
    match /home-cards/{cardId}/{fileName} {
      allow read: if true; // 모든 사용자가 읽기 가능
      allow write: if request.auth != null && 
        request.auth.token.email in ["beagle3651@gmail.com", "boxro.crafts@gmail.com"]; // 관리자만 쓰기 가능
    }
    
    // 배너 썸네일 이미지 (새로 추가)
    match /banners/{bannerId}/{fileName} {
      allow read: if true; // 모든 사용자가 읽기 가능
      allow write: if request.auth != null && 
        request.auth.token.email in ["beagle3651@gmail.com", "boxro.crafts@gmail.com"]; // 관리자만 쓰기 가능
    }
    
    // 스토리/스토어 썸네일 이미지
    match /story-thumbnails/{storyId}/{fileName} {
      allow read: if true; // 모든 사용자가 읽기 가능
      allow write: if request.auth != null && 
        request.auth.token.email in ["beagle3651@gmail.com", "boxro.crafts@gmail.com"]; // 관리자만 쓰기 가능
    }
    
    match /store-thumbnails/{storeId}/{fileName} {
      allow read: if true; // 모든 사용자가 읽기 가능
      allow write: if request.auth != null && 
        request.auth.token.email in ["beagle3651@gmail.com", "boxro.crafts@gmail.com"]; // 관리자만 쓰기 가능
    }
    
    // 스토리/스토어 뷰 상단 이미지
    match /story-view-images/{storyId}/{fileName} {
      allow read: if true; // 모든 사용자가 읽기 가능
      allow write: if request.auth != null && 
        request.auth.token.email in ["beagle3651@gmail.com", "boxro.crafts@gmail.com"]; // 관리자만 쓰기 가능
    }
    
    match /store-view-images/{storeId}/{fileName} {
      allow read: if true; // 모든 사용자가 읽기 가능
      allow write: if request.auth != null && 
        request.auth.token.email in ["beagle3651@gmail.com", "boxro.crafts@gmail.com"]; // 관리자만 쓰기 가능
    }
    
    // 스토리/스토어 에디터 이미지
    match /story-editor-images/{storyId}/{fileName} {
      allow read: if true; // 모든 사용자가 읽기 가능
      allow write: if request.auth != null && 
        request.auth.token.email in ["beagle3651@gmail.com", "boxro.crafts@gmail.com"]; // 관리자만 쓰기 가능
    }
    
    match /store-editor-images/{storeId}/{fileName} {
      allow read: if true; // 모든 사용자가 읽기 가능
      allow write: if request.auth != null && 
        request.auth.token.email in ["beagle3651@gmail.com", "boxro.crafts@gmail.com"]; // 관리자만 쓰기 가능
    }
  }
}
